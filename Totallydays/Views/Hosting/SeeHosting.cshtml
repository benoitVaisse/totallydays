@model Hosting
@{
    ViewData["Title"] = "SeeHosting";
    AppUser User = await UserManager.GetUserAsync(this.User);
    int index = 0;
    int jindex = 0;
}

    <div>
        <div class="ad_title" style="background-image: url('@Url.Content("~/img/hosting/coverImage/"+Model.Cover_image)')">
            <div class="container my-5">
                <h1>@Model.Title </h1>
                <p>@Model.Resume </p>
            </div>
        </div>
        <div class="container">
            @if (Model.Active == false)
            {
                <div class="alert alert-danger" role="alert">
                    Cette Hébergement n'est pas encore activé par l'administration
                </div>
            }

            @if (Model.Published == false)
            {
                <div class="alert alert-danger" role="alert">
                    Vous n'avez pas encore publié cette hébergement
                </div>
            }
            <h2 class="my-4">@Model.Title</h2>
            <div class="row">
                <div class="col-md-8 mb-3">

                    <div>
                        <div class="carousel-image">
                            <div id="carouselCaptions" class="carousel slide" data-ride="carousel">
                                <ol class="carousel-indicators">
                                    @foreach (Image i in Model.Images)
                                    {
                                        <li data-target="#carouselCaptions" data-slide-to="@index" @(index == 0 ? "class=\"active\"" : "" )></li>
                                        index++;

                                    }
                                </ol>
                                <div class="carousel-inner">
                                    @foreach (Image i in Model.Images)
                                    {
                                        <div class="carousel-item @(jindex == 0 ? "active":"" )">
                                            <img src="~/img/hosting/img/@Model.Hosting_id/@i.File" class="d-block w-100">
                                        </div>
                                        jindex++;
                                    }
                                </div>
                                <a class="carousel-control-prev" href="#carouselCaptions" role="button" data-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Previous</span>
                                </a>
                                <a class="carousel-control-next" href="#carouselCaptions" role="button" data-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Next</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 my-5">
                    <div class="row">
                        <div class="col-md-4 avatar mb-3">
                            @if (User.Picture != null)
                            {
                                <img src="~/img/avatar/@User.Id/@User.Picture" class="avatar avatar-middle" />
                            }
                            else
                            {
                                <img src="~/img/avatar/homme.jpg" class="avatar avatar-middle" />
                            }
                        </div>
                        <div class="col">
                            <a class="text-info" href="#">
                                <h3>@Model.User.Lastname @Model.User.Firstname</h3>
                            </a>
                            <span class="badge badge-info"> @Model.User.Hostings.Count() Annonce(s) </span>
                        </div>
                    </div>
                    @Html.Raw(User.Description != null ? User.DescriptionShow() : "")
                </div>
            </div>
            <hr />
            <div>
                <div class="my-3">
                    @Html.Raw(Model.ResumeShow());
                </div>
                <div class="my-3">
                    @Html.Raw(Model.DescriptionShow());
                </div>
            </div>
            <hr />

            <div id="bedrooms">
                <h4>Chambres</h4>
                <partial name="~/Views/Hosting/_partial/__block_bedroom.cshtml" model="@Model" />
            </div>

            <hr />
            <div class="hosting-equipment-block my-3">
                <h4>Equipements</h4>
                <div class="hosting-equipments">
                    @foreach (Hosting_Equipment he in Model.Hosting_Equipment)
                    {
                        <div> @he.Equipment.Name </div>
                    }
                </div>
            </div>

            <hr />
            <div class="coordinate-hosting" data-lat="@Model.Lat" data-lng="@Model.Lng"></div>
            <partial name="/Views/Hosting/_partial/_map_hosting.cshtml" model="@Model" />
            <hr>
            <partial name="/Views/Hosting/_partial/_hosting_comment.cshtml" model="@Model" />
            @if (User == Model.User)
            {
                <div class="booking-block-hosting">
                    <partial name="/Views/Hosting/_partial/_block_unavalaible_date.cshtml" model="@this.ViewBag.unavailable_date" />
                </div>
                <div id="modal_unavailable_date_block">
                    <partial name="/Views/Modal/MyUnavailableDateHostingModal.cshtml" model="@Model.GetMyNextUnavailableDate()" />
                </div>
            }
            else
            {
                <div class="booking-block-hosting">
                    <partial name="/Views/Hosting/_partial/_block_booking.cshtml" model="@this.ViewBag.bookingModel" />
                </div>
            }

        </div>
        
    </div>





@section Scripts{

    <script>
            jsDateUnavailable = [
                @foreach (DateTime date in Model.getUnavailableDays())
                {
                    @:'@date.ToString("dd/MM/yyyy")',
                }
            ];

             amount = @Model.Price;
        
    </script>
}




